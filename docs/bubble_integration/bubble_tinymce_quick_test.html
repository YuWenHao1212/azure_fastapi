<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>å¿«é€Ÿ TinyMCE æ¸¬è©¦å·¥å…·</title>
    <style>
        .quick-test {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: #fff;
            border: 2px solid #007bff;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            z-index: 9999;
            max-width: 350px;
            font-family: Arial, sans-serif;
            font-size: 12px;
        }
        
        .quick-test h3 {
            margin: 0 0 10px 0;
            color: #007bff;
            font-size: 14px;
        }
        
        .btn-quick {
            display: inline-block;
            padding: 5px 10px;
            margin: 2px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-size: 11px;
        }
        
        .btn-quick:hover {
            background: #0056b3;
        }
        
        .status-box {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 8px;
            margin-top: 10px;
            max-height: 200px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 10px;
            line-height: 1.3;
        }
        
        .status-good { color: #28a745; }
        .status-warn { color: #ffc107; }
        .status-error { color: #dc3545; }
        
        .minimize-btn {
            position: absolute;
            top: 5px;
            right: 8px;
            background: none;
            border: none;
            font-size: 16px;
            cursor: pointer;
            color: #6c757d;
        }
        
        .minimized {
            height: 40px;
            overflow: hidden;
        }
    </style>
</head>
<body>
    <div id="quickTest" class="quick-test">
        <button class="minimize-btn" onclick="toggleMinimize()">âˆ’</button>
        <h3>ğŸ” TinyMCE å¿«é€Ÿæª¢æ¸¬</h3>
        
        <div class="button-group">
            <button class="btn-quick" onclick="quickCheck()">æª¢æ¸¬</button>
            <button class="btn-quick" onclick="deepScanHTML()">æ·±åº¦æƒæ</button>
            <button class="btn-quick" onclick="findGlobalObjects()">å…¨åŸŸç‰©ä»¶</button>
            <button class="btn-quick" onclick="scanBubbleElements()">Bubbleå…ƒç´ </button>
            <button class="btn-quick" onclick="startDOMWatch()">ç›£æ§DOM</button>
            <button class="btn-quick" onclick="getContent()">å–å…§å®¹</button>
            <button class="btn-quick" onclick="insertTest()">æ’å…¥æ¸¬è©¦</button>
            <button class="btn-quick" onclick="clearStatus()">æ¸…é™¤</button>
        </div>
        
        <div id="status" class="status-box"></div>
    </div>

    <script>
        let isMinimized = false;
        let currentEditor = null;
        let currentIframeEditor = null;
        let domObserver = null;
        let isDOMWatching = false;
        
        function log(message, type = 'info') {
            const status = document.getElementById('status');
            const timestamp = new Date().toLocaleTimeString();
            const className = type === 'error' ? 'status-error' : 
                            type === 'warn' ? 'status-warn' : 
                            type === 'good' ? 'status-good' : '';
            
            status.innerHTML += `<div class="${className}">[${timestamp}] ${message}</div>`;
            status.scrollTop = status.scrollHeight;
            console.log(`[TinyMCE Quick Test] ${message}`);
        }
        
        function clearStatus() {
            document.getElementById('status').innerHTML = '';
        }
        
        function toggleMinimize() {
            const container = document.getElementById('quickTest');
            const btn = container.querySelector('.minimize-btn');
            isMinimized = !isMinimized;
            
            if (isMinimized) {
                container.classList.add('minimized');
                btn.textContent = '+';
            } else {
                container.classList.remove('minimized');
                btn.textContent = 'âˆ’';
            }
        }
        
        function quickCheck() {
            clearStatus();
            log('ğŸš€ é–‹å§‹å¿«é€Ÿæª¢æ¸¬...', 'info');
            
            // æª¢æŸ¥ TinyMCE
            if (typeof tinymce !== 'undefined') {
                log(`âœ… TinyMCE v${tinymce.majorVersion}.${tinymce.minorVersion} å·²è¼‰å…¥`, 'good');
                log(`ğŸ“Š ç·¨è¼¯å™¨æ•¸é‡: ${tinymce.editors.length}`, 'info');
                
                if (tinymce.editors.length > 0) {
                    currentEditor = tinymce.editors[0];
                    log(`âœ… ç•¶å‰ç·¨è¼¯å™¨: ${currentEditor.id}`, 'good');
                    log(`ğŸ“ å…§å®¹é•·åº¦: ${currentEditor.getContent().length}`, 'info');
                } else {
                    log('âš ï¸ æ²’æœ‰æ´»å‹•ç·¨è¼¯å™¨', 'warn');
                }
            } else {
                log('âŒ TinyMCE æœªè¼‰å…¥', 'error');
            }
            
            // æª¢æŸ¥å¯ç·¨è¼¯å…ƒç´ 
            const editableElements = document.querySelectorAll('[contenteditable="true"]');
            log(`ğŸ“ å¯ç·¨è¼¯å…ƒç´ : ${editableElements.length}`, 'info');
            
            // æª¢æŸ¥ iframe
            const iframes = document.querySelectorAll('iframe');
            log(`ğŸ–¼ï¸ iframe æ•¸é‡: ${iframes.length}`, 'info');
            
            // æª¢æŸ¥ textarea
            const textareas = document.querySelectorAll('textarea');
            log(`ğŸ“„ textarea æ•¸é‡: ${textareas.length}`, 'info');
        }
        
        function getContent() {
            clearStatus();
            log('ğŸ“– ç²å–å…§å®¹...', 'info');
            
            if (currentEditor) {
                const content = currentEditor.getContent();
                const textContent = currentEditor.getContent({format: 'text'});
                log(`âœ… TinyMCE å…§å®¹ (${content.length} chars)`, 'good');
                log(content.substring(0, 200) + (content.length > 200 ? '...' : ''), 'info');
                
            } else if (currentIframeEditor) {
                const content = currentIframeEditor.innerHTML;
                log(`âœ… iframe å…§å®¹ (${content.length} chars)`, 'good');
                log(content.substring(0, 200) + (content.length > 200 ? '...' : ''), 'info');
                
            } else {
                const editableElements = document.querySelectorAll('[contenteditable="true"]');
                if (editableElements.length > 0) {
                    const el = editableElements[0];
                    log(`ğŸ“ å¯ç·¨è¼¯å…ƒç´ å…§å®¹ (${el.innerHTML.length} chars)`, 'info');
                    log(el.innerHTML.substring(0, 200) + (el.innerHTML.length > 200 ? '...' : ''), 'info');
                } else {
                    log('âŒ æ²’æœ‰æ‰¾åˆ°å…§å®¹', 'error');
                }
            }
        }
        
        // æ·±åº¦æƒæ HTML çµæ§‹
        function deepScanHTML() {
            clearStatus();
            log('ğŸ” æ·±åº¦æƒæ HTML çµæ§‹...', 'info');
            
            // æƒææ‰€æœ‰åŒ…å« 'editor', 'rich', 'text', 'mce', 'tiny' é—œéµå­—çš„å…ƒç´ 
            const keywords = ['editor', 'rich', 'text', 'mce', 'tiny', 'bubble'];
            
            keywords.forEach(keyword => {
                // æƒæ ID
                const idElements = document.querySelectorAll(`[id*="${keyword}"]`);
                if (idElements.length > 0) {
                    log(`ğŸ†” ID åŒ…å« "${keyword}": ${idElements.length} å€‹`, 'info');
                    idElements.forEach(el => {
                        log(`   - ${el.tagName}#${el.id} (class: ${el.className || 'none'})`, 'info');
                        
                        // æª¢æŸ¥æ˜¯å¦æœ‰å¯ç·¨è¼¯å±¬æ€§
                        if (el.contentEditable === 'true') {
                            log(`     âœ… å¯ç·¨è¼¯å…ƒç´ ï¼å…§å®¹é•·åº¦: ${el.innerHTML.length}`, 'good');
                            currentIframeEditor = el;
                        }
                    });
                }
                
                // æƒæ Class
                const classElements = document.querySelectorAll(`[class*="${keyword}"]`);
                if (classElements.length > 0) {
                    log(`ğŸ·ï¸ Class åŒ…å« "${keyword}": ${classElements.length} å€‹`, 'info');
                    classElements.forEach(el => {
                        log(`   - ${el.tagName}.${el.className} (id: ${el.id || 'none'})`, 'info');
                        
                        if (el.contentEditable === 'true') {
                            log(`     âœ… å¯ç·¨è¼¯å…ƒç´ ï¼å…§å®¹é•·åº¦: ${el.innerHTML.length}`, 'good');
                            currentIframeEditor = el;
                        }
                    });
                }
                
                // æƒæ data å±¬æ€§
                const dataElements = document.querySelectorAll(`[data-*="${keyword}"], [data-*^="${keyword}"], [data-*$="${keyword}"]`);
                if (dataElements.length > 0) {
                    log(`ğŸ“Š Data å±¬æ€§åŒ…å« "${keyword}": ${dataElements.length} å€‹`, 'info');
                }
            });
            
            // ç‰¹åˆ¥æª¢æŸ¥æ‰€æœ‰ contentEditable å…ƒç´ 
            const editableElements = document.querySelectorAll('[contenteditable="true"]');
            log(`\nğŸ“ æ‰€æœ‰å¯ç·¨è¼¯å…ƒç´ : ${editableElements.length}`, 'info');
            editableElements.forEach((el, index) => {
                log(`   ${index + 1}. ${el.tagName} (id: ${el.id || 'none'}, class: ${el.className || 'none'})`, 'info');
                log(`      å…§å®¹é•·åº¦: ${el.innerHTML.length}, æ–‡å­—é•·åº¦: ${el.textContent.length}`, 'info');
                
                if (el.innerHTML.length > 0) {
                    log(`      å…§å®¹é è¦½: ${el.innerHTML.substring(0, 100)}...`, 'info');
                }
            });
        }
        
        // æœå°‹å…¨åŸŸç‰©ä»¶
        function findGlobalObjects() {
            clearStatus();
            log('ğŸŒ æœå°‹å…¨åŸŸç‰©ä»¶...', 'info');
            
            // æª¢æŸ¥å¸¸è¦‹çš„ç·¨è¼¯å™¨å…¨åŸŸç‰©ä»¶
            const editorObjects = [
                'tinymce', 'TINYMCE', 'TinyMCE',
                'editor', 'Editor', 'EDITOR',
                'bubble', 'Bubble', 'BUBBLE',
                'richText', 'RichText', 'RICHTEXT',
                'textEditor', 'TextEditor'
            ];
            
            editorObjects.forEach(objName => {
                if (window[objName]) {
                    log(`âœ… æ‰¾åˆ°å…¨åŸŸç‰©ä»¶: window.${objName}`, 'good');
                    log(`   é¡å‹: ${typeof window[objName]}`, 'info');
                    
                    // æª¢æŸ¥ç‰©ä»¶å±¬æ€§
                    if (typeof window[objName] === 'object') {
                        const keys = Object.keys(window[objName]);
                        log(`   å±¬æ€§æ•¸é‡: ${keys.length}`, 'info');
                        
                        // é¡¯ç¤ºå‰ 10 å€‹å±¬æ€§
                        keys.slice(0, 10).forEach(key => {
                            log(`   - ${key}: ${typeof window[objName][key]}`, 'info');
                        });
                        
                        // ç‰¹åˆ¥æª¢æŸ¥ç·¨è¼¯å™¨ç›¸é—œå±¬æ€§
                        if (window[objName].editors) {
                            log(`   ğŸ“ editors å±¬æ€§: ${window[objName].editors.length} å€‹ç·¨è¼¯å™¨`, 'info');
                        }
                        
                        if (window[objName].get) {
                            log(`   ğŸ”§ æœ‰ get() æ–¹æ³•`, 'info');
                        }
                        
                        if (window[objName].getContent) {
                            log(`   ğŸ“„ æœ‰ getContent() æ–¹æ³•`, 'info');
                        }
                    }
                }
            });
            
            // æª¢æŸ¥ window ç‰©ä»¶ä¸Šæ‰€æœ‰åŒ…å« editor é—œéµå­—çš„å±¬æ€§
            log('\nğŸ” æœå°‹ window ç‰©ä»¶ä¸­çš„ç·¨è¼¯å™¨ç›¸é—œå±¬æ€§...', 'info');
            Object.keys(window).forEach(key => {
                const lowerKey = key.toLowerCase();
                if (lowerKey.includes('editor') || lowerKey.includes('tiny') || lowerKey.includes('mce') || lowerKey.includes('rich')) {
                    log(`ğŸ¯ window.${key}: ${typeof window[key]}`, 'info');
                }
            });
        }
        
        // æƒæ Bubble.io ç‰¹æœ‰å…ƒç´ 
        function scanBubbleElements() {
            clearStatus();
            log('ğŸ«§ æƒæ Bubble.io å…ƒç´ ...', 'info');
            
            // Bubble.io ç‰¹æœ‰çš„é¸æ“‡å™¨
            const bubbleSelectors = [
                '.bubble-element',
                '[data-bubble]',
                '[class*="bubble"]',
                '[id*="bubble"]',
                '.RichTextEditor',
                '[data-type="RichTextEditor"]',
                '.RepeatingGroup',
                '.Input',
                '.MultilineInput'
            ];
            
            bubbleSelectors.forEach(selector => {
                const elements = document.querySelectorAll(selector);
                if (elements.length > 0) {
                    log(`ğŸ¯ ${selector}: ${elements.length} å€‹`, 'info');
                    
                    elements.forEach((el, index) => {
                        log(`   ${index + 1}. ${el.tagName}`, 'info');
                        log(`      ID: ${el.id || 'none'}`, 'info');
                        log(`      Class: ${el.className || 'none'}`, 'info');
                        
                        // æª¢æŸ¥ data å±¬æ€§
                        Array.from(el.attributes).forEach(attr => {
                            if (attr.name.startsWith('data-')) {
                                log(`      ${attr.name}: ${attr.value}`, 'info');
                            }
                        });
                        
                        // æª¢æŸ¥æ˜¯å¦åŒ…å«ç·¨è¼¯å™¨
                        const innerEditors = el.querySelectorAll('[contenteditable="true"], iframe, textarea');
                        if (innerEditors.length > 0) {
                            log(`      âœ… åŒ…å« ${innerEditors.length} å€‹ç·¨è¼¯å™¨å…ƒç´ `, 'good');
                            
                            innerEditors.forEach((innerEl, innerIndex) => {
                                log(`         ${innerIndex + 1}. ${innerEl.tagName} (contentEditable: ${innerEl.contentEditable})`, 'info');
                                if (innerEl.tagName === 'IFRAME') {
                                    log(`            iframe src: ${innerEl.src || 'none'}`, 'info');
                                    log(`            iframe title: ${innerEl.title || 'none'}`, 'info');
                                }
                            });
                        }
                    });
                }
            });
            
            // ç‰¹åˆ¥æª¢æŸ¥ Bubble.io çš„äº‹ä»¶è™•ç†å™¨
            log('\nğŸ“¡ æª¢æŸ¥ Bubble.io äº‹ä»¶è™•ç†å™¨...', 'info');
            const allElements = document.querySelectorAll('*');
            let eventCount = 0;
            
            allElements.forEach(el => {
                Object.keys(el).forEach(key => {
                    if (key.startsWith('on') && typeof el[key] === 'function') {
                        eventCount++;
                    }
                });
            });
            
            log(`æ‰¾åˆ° ${eventCount} å€‹äº‹ä»¶è™•ç†å™¨`, 'info');
        }
        
        // DOM è®ŠåŒ–ç›£æ§
        function startDOMWatch() {
            clearStatus();
            
            if (isDOMWatching) {
                // åœæ­¢ç›£æ§
                if (domObserver) {
                    domObserver.disconnect();
                    domObserver = null;
                }
                isDOMWatching = false;
                log('â¹ï¸ DOM ç›£æ§å·²åœæ­¢', 'warn');
                
                // æ›´æ–°æŒ‰éˆ•æ–‡å­—
                const btn = event.target;
                btn.textContent = 'ç›£æ§DOM';
                return;
            }
            
            log('ğŸ”„ é–‹å§‹ç›£æ§ DOM è®ŠåŒ–...', 'info');
            log('ğŸ“¡ å°‡æ•æ‰æ‰€æœ‰åŒ…å«ç·¨è¼¯å™¨é—œéµå­—çš„å…ƒç´ è®ŠåŒ–', 'info');
            
            isDOMWatching = true;
            
            // æ›´æ–°æŒ‰éˆ•æ–‡å­—
            const btn = event.target;
            btn.textContent = 'åœæ­¢ç›£æ§';
            
            // å‰µå»º MutationObserver
            domObserver = new MutationObserver(function(mutations) {
                mutations.forEach(function(mutation) {
                    // æª¢æŸ¥æ–°å¢çš„ç¯€é»
                    if (mutation.type === 'childList') {
                        mutation.addedNodes.forEach(function(node) {
                            if (node.nodeType === Node.ELEMENT_NODE) {
                                checkNewElement(node, 'æ–°å¢');
                            }
                        });
                        
                        mutation.removedNodes.forEach(function(node) {
                            if (node.nodeType === Node.ELEMENT_NODE) {
                                checkNewElement(node, 'ç§»é™¤');
                            }
                        });
                    }
                    
                    // æª¢æŸ¥å±¬æ€§è®ŠåŒ–
                    if (mutation.type === 'attributes') {
                        const target = mutation.target;
                        if (isEditorRelated(target)) {
                            log(`ğŸ”§ å±¬æ€§è®ŠåŒ–: ${target.tagName}.${target.className || ''} - ${mutation.attributeName}`, 'info');
                        }
                    }
                });
            });
            
            // é–‹å§‹ç›£æ§
            domObserver.observe(document.body, {
                childList: true,
                subtree: true,
                attributes: true,
                attributeFilter: ['class', 'id', 'contenteditable', 'data-type']
            });
            
            log('âœ… DOM ç›£æ§å·²å•Ÿå‹•ï¼Œç­‰å¾…è®ŠåŒ–...', 'good');
        }
        
        // æª¢æŸ¥æ–°å…ƒç´ æ˜¯å¦èˆ‡ç·¨è¼¯å™¨ç›¸é—œ
        function checkNewElement(element, action) {
            if (isEditorRelated(element)) {
                log(`ğŸ†• ${action}å…ƒç´ : ${element.tagName}`, action === 'æ–°å¢' ? 'good' : 'warn');
                log(`   ID: ${element.id || 'none'}`, 'info');
                log(`   Class: ${element.className || 'none'}`, 'info');
                log(`   ContentEditable: ${element.contentEditable || 'false'}`, 'info');
                
                // å¦‚æœæ˜¯å¯ç·¨è¼¯å…ƒç´ ï¼Œè‡ªå‹•è¨­ç½®ç‚ºç•¶å‰ç·¨è¼¯å™¨
                if (element.contentEditable === 'true') {
                    currentIframeEditor = element;
                    log(`   âœ… å·²è¨­ç½®ç‚ºç•¶å‰ç·¨è¼¯å™¨`, 'good');
                }
                
                // å¦‚æœæ˜¯ iframeï¼Œæª¢æŸ¥å…§å®¹
                if (element.tagName === 'IFRAME') {
                    setTimeout(() => {
                        try {
                            const iframeDoc = element.contentDocument || element.contentWindow.document;
                            if (iframeDoc) {
                                const editableContent = iframeDoc.querySelector('[contenteditable="true"], .mce-content-body');
                                if (editableContent) {
                                    currentIframeEditor = editableContent;
                                    log(`   âœ… iframe ä¸­ç™¼ç¾å¯ç·¨è¼¯å…§å®¹`, 'good');
                                }
                            }
                        } catch (e) {
                            log(`   âš ï¸ ç„¡æ³•è¨ªå• iframe å…§å®¹`, 'warn');
                        }
                    }, 1000);
                }
                
                // æª¢æŸ¥å­å…ƒç´ 
                const innerEditors = element.querySelectorAll('[contenteditable="true"], iframe, textarea');
                if (innerEditors.length > 0) {
                    log(`   ğŸ“ åŒ…å« ${innerEditors.length} å€‹ç·¨è¼¯å™¨å­å…ƒç´ `, 'info');
                }
            }
            
            // æª¢æŸ¥æ˜¯å¦åŒ…å« TinyMCE ç›¸é—œçš„å­å…ƒç´ 
            const tinyElements = element.querySelectorAll('[id*="mce"], [class*="mce"], [id*="tinymce"], [class*="tinymce"]');
            if (tinyElements.length > 0) {
                log(`ğŸ” ${action}äº†åŒ…å« TinyMCE çš„å…ƒç´  (${tinyElements.length} å€‹ç›¸é—œå­å…ƒç´ )`, 'info');
            }
        }
        
        // åˆ¤æ–·å…ƒç´ æ˜¯å¦èˆ‡ç·¨è¼¯å™¨ç›¸é—œ
        function isEditorRelated(element) {
            const keywords = ['editor', 'rich', 'text', 'mce', 'tiny', 'bubble'];
            const id = element.id || '';
            const className = element.className || '';
            const tagName = element.tagName || '';
            
            return keywords.some(keyword => 
                id.toLowerCase().includes(keyword) ||
                className.toLowerCase().includes(keyword) ||
                tagName.toLowerCase().includes(keyword)
            ) || element.contentEditable === 'true' || tagName === 'IFRAME' || tagName === 'TEXTAREA';
        }
        
        function checkIframes() {
            clearStatus();
            log('ğŸ–¼ï¸ æª¢æŸ¥ iframe...', 'info');
            
            const iframes = document.querySelectorAll('iframe');
            log(`æ‰¾åˆ° ${iframes.length} å€‹ iframe`, 'info');
            
            iframes.forEach((iframe, index) => {
                log(`--- iframe ${index + 1} ---`, 'info');
                log(`ID: ${iframe.id || 'no ID'}`, 'info');
                log(`Title: ${iframe.title || 'no title'}`, 'info');
                
                try {
                    const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                    if (iframeDoc) {
                        const editableContent = iframeDoc.querySelector('[contenteditable="true"], .mce-content-body');
                        if (editableContent) {
                            currentIframeEditor = editableContent;
                            log(`âœ… æ‰¾åˆ°å¯ç·¨è¼¯å…§å®¹ (${editableContent.innerHTML.length} chars)`, 'good');
                        } else {
                            log('âŒ æ²’æœ‰å¯ç·¨è¼¯å…§å®¹', 'error');
                        }
                    } else {
                        log('âŒ ç„¡æ³•è¨ªå• iframe', 'error');
                    }
                } catch (error) {
                    log(`âŒ iframe éŒ¯èª¤: ${error.message}`, 'error');
                }
            });
        }
        
        function insertTest() {
            clearStatus();
            log('ğŸ§ª æ’å…¥æ¸¬è©¦å…§å®¹...', 'info');
            
            const testHTML = `
                <h2>æ¸¬è©¦å±¥æ­·æ¨™é¡Œ</h2>
                <p class="opt-new">é€™æ˜¯ä¸€å€‹ <span class="opt-keyword">æ–°å¢é—œéµå­—</span> çš„æ®µè½ï¼ŒåŒ…å« <span class="opt-placeholder">[PERCENTAGE]</span> ä½”ä½ç¬¦ã€‚</p>
                <ul>
                    <li class="opt-modified">ä¿®æ”¹éçš„é …ç›®with <span class="opt-keyword-existing">åŸæœ‰é—œéµå­—</span></li>
                    <li>æ™®é€šé …ç›®with <span class="opt-strength">å¼·èª¿å…§å®¹</span></li>
                </ul>
            `;
            
            let inserted = false;
            
            // å˜—è©¦æ’å…¥åˆ° TinyMCE
            if (currentEditor) {
                try {
                    currentEditor.setContent(testHTML);
                    log('âœ… å·²æ’å…¥åˆ° TinyMCE ç·¨è¼¯å™¨', 'good');
                    inserted = true;
                } catch (error) {
                    log(`âŒ TinyMCE æ’å…¥å¤±æ•—: ${error.message}`, 'error');
                }
            }
            
            // å˜—è©¦æ’å…¥åˆ° iframe
            if (!inserted && currentIframeEditor) {
                try {
                    currentIframeEditor.innerHTML = testHTML;
                    log('âœ… å·²æ’å…¥åˆ° iframe ç·¨è¼¯å™¨', 'good');
                    inserted = true;
                } catch (error) {
                    log(`âŒ iframe æ’å…¥å¤±æ•—: ${error.message}`, 'error');
                }
            }
            
            // å˜—è©¦æ’å…¥åˆ°å¯ç·¨è¼¯å…ƒç´ 
            if (!inserted) {
                const editableElement = document.querySelector('[contenteditable="true"]');
                if (editableElement) {
                    editableElement.innerHTML = testHTML;
                    log('âœ… å·²æ’å…¥åˆ°å¯ç·¨è¼¯å…ƒç´ ', 'good');
                    inserted = true;
                }
            }
            
            if (!inserted) {
                log('âŒ æ²’æœ‰æ‰¾åˆ°å¯æ’å…¥çš„ç·¨è¼¯å™¨', 'error');
            }
        }
        
        // è‡ªå‹•åˆå§‹åŒ–
        setTimeout(() => {
            quickCheck();
        }, 1000);
        
        // å®šæœŸæª¢æŸ¥ç·¨è¼¯å™¨è®ŠåŒ–
        setInterval(() => {
            if (typeof tinymce !== 'undefined' && tinymce.editors.length > 0 && !currentEditor) {
                currentEditor = tinymce.editors[0];
                log(`ğŸ”„ è‡ªå‹•æª¢æ¸¬åˆ°ç·¨è¼¯å™¨: ${currentEditor.id}`, 'good');
            }
        }, 3000);
    </script>
</body>
</html>